{"version":3,"file":"web3w.umd.js","sources":["../src/utils/log.js","../src/utils/store.js","../src/utils/builtin.js","../src/utils/index.js","../src/utils/ethers.js","../src/index.js"],"sourcesContent":["export function makeLog(log) {\n  if (!log) {\n    return voidLog;\n  }\n\n  if (log === console) {\n    return {\n      trace: log.trace,\n      debug: log.trace,\n      info: log.info,\n      warn: log.warn,\n      error: log.error,\n      fatal: log.fatal,\n      silent: log.log,\n    }  \n  }\n  let defaultLog = log.fatal || log.error || log.warn || log.info || log.debug || log.silent || log.log;\n  if (!defaultLog) {\n    defaultLog = console.log.bind(console);\n  } else {\n    defaultLog = defaultLog.bind(log);\n  }\n  return {\n    trace: log.trace ? log.trace.bind(log) : defaultLog,\n    debug: log.debug ? log.debug.bind(log) : defaultLog,\n    info: log.info ? log.info.bind(log) : defaultLog,\n    warn: log.warn ? log.warn.bind(log) : defaultLog,\n    error: log.error ? log.error.bind(log) : defaultLog,\n    fatal: log.fatal ? log.fatal.bind(log) : defaultLog,\n    silent: log.silent ? log.silent.bind(log) : defaultLog,\n  }\n  \n}\n\nexport const voidLog = {\n  trace:() => {},\n  debug:() => {},\n  info:() => {},\n  warn:() => {},\n  error:() => {},\n  fatal:() => {},\n  silent:() => {},\n};\n","function noop() {}\nfunction safe_not_equal(a, b) {\n\treturn a != a ? b == b : a !== b || ((a && typeof a === 'object') || typeof a === 'function');\n}\n\n// global queue\nconst subscriber_queue = [];\nexport function writable(value, start) {\n    if (!start) { start = noop; }\n\tlet stop;\n\tconst subscribers = [];\n\n\tfunction set(new_value) {\n\t\tif (safe_not_equal(value, new_value)) {\n\t\t\tvalue = new_value;\n\t\t\tif (stop) { // store is ready\n\t\t\t\tconst run_queue = !subscriber_queue.length;\n\t\t\t\tfor (let i = 0; i < subscribers.length; i += 1) {\n\t\t\t\t\tconst s = subscribers[i];\n\t\t\t\t\ts[1]();\n\t\t\t\t\tsubscriber_queue.push(s, value);\n\t\t\t\t}\n\t\t\t\tif (run_queue) {\n\t\t\t\t\tfor (let i = 0; i < subscriber_queue.length; i += 2) {\n\t\t\t\t\t\tsubscriber_queue[i][0](subscriber_queue[i + 1]);\n\t\t\t\t\t}\n\t\t\t\t\tsubscriber_queue.length = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction update(fn){\n\t\tset(fn(value));\n\t}\n\n\tfunction subscribe(run, invalidate) {\n        if (!invalidate) { invalidate = noop; }\n\t\tconst subscriber = [run, invalidate];\n\t\tsubscribers.push(subscriber);\n\t\tif (subscribers.length === 1) {\n\t\t\tstop = start(set) || noop;\n\t\t}\n\t\trun(value);\n\n\t\treturn () => {\n\t\t\tconst index = subscribers.indexOf(subscriber);\n\t\t\tif (index !== -1) {\n\t\t\t\tsubscribers.splice(index, 1);\n\t\t\t}\n\t\t\tif (subscribers.length === 0) {\n\t\t\t\tstop();\n\t\t\t\tstop = null;\n\t\t\t}\n\t\t};\n\t}\n\n\treturn { set, update, subscribe };\n}\n\nexport class Store {\n\n  constructor(value, start) {\n    this.value = value;\n    this._start = start || noop;\n\t  this._stop = undefined;\n\t  this._subscribers = [];\n  }\n\n  set(new_value) {\n\t\tif (safe_not_equal(this.value, new_value)) {\n\t\t\tthis.value = new_value;\n\t\t\tif (this._stop) { // store is ready\n\t\t\t\tconst run_queue = !subscriber_queue.length;\n\t\t\t\tfor (let i = 0; i < this._subscribers.length; i += 1) {\n\t\t\t\t\tconst s = this._subscribers[i];\n\t\t\t\t\ts[1]();\n\t\t\t\t\tsubscriber_queue.push(s, value);\n\t\t\t\t}\n\t\t\t\tif (run_queue) {\n\t\t\t\t\tfor (let i = 0; i < subscriber_queue.length; i += 2) {\n\t\t\t\t\t\tsubscriber_queue[i][0](subscriber_queue[i + 1]);\n\t\t\t\t\t}\n\t\t\t\t\tsubscriber_queue.length = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n  }\n  \n  update(fn){\n\t\tthis.set(fn(value));\n\t}\n  subscribe(run, invalidate) {\n    if (!invalidate) { invalidate = noop; }\n    const subscriber = [run, invalidate];\n    this._subscribers.push(subscriber);\n    if (this._subscribers.length === 1) {\n      this._stop = this.start(set) || noop;\n    }\n    run(value);\n\n    return () => {\n      const index = this._subscribers.indexOf(subscriber);\n      if (index !== -1) {\n        this._subscribers.splice(index, 1);\n      }\n      if (this._subscribers.length === 0) {\n        this._stop();\n        this._stop = null;\n      }\n    };\n  }\n}\n","export function getEthereum() {\n  if (typeof window !== 'undefined') {\n      if (window.ethereum) {\n          return window.ethereum;\n      } else if (window.web3) {\n          return window.web3.currentProvider;\n      }\n  }\n  return null;\n}\n\nexport function fetchEthereum() {\n  // TODO test with document.readyState !== 'complete' || document.readyState === 'interactive'\n  return new Promise((resolve, reject) => {\n      if(document.readyState !== 'complete') {\n          document.onreadystatechange = function() {\n              if (document.readyState === 'complete') {\n                  document.onreadystatechange = null;\n                  resolve(getEthereum());    \n              }\n          };\n      } else {\n          resolve(getEthereum());\n      }\n  });\n}\n\nexport function getVendor(ethereum) {\n  if (!ethereum) {\n      return undefined;\n  } else if(ethereum.isMetaMask) {\n      return 'Metamask';\n  } else if(navigator.userAgent.indexOf(\"Opera\") != -1 || navigator.userAgent.indexOf(\"OPR/\") != -1) {\n      return 'Opera';\n  } else {\n      return 'unknown';\n  }\n  // TODO\n}\n","export function timeout(time, p, config) {\n  return new Promise((resolve, reject) => {\n    let _timedOut = false;\n    const timer = setTimeout(() => {\n      _timedOut = true;\n      if (!config) {\n        reject(new Error(\"TimedOut\"));\n      } else {\n        if (typeof config === \"function\") {\n          resolve(config());\n        } else {\n          reject(config.error || config)\n        }\n      }\n    }, time);\n    p.then((v) => {\n      if (!_timedOut) {\n        clearTimeout(timer);\n        resolve(v);\n      } // TODO else console.log\n    }).catch((e) =>{\n      if (!_timedOut) {\n        clearTimeout(timer);\n        reject(e);\n      } // TODO else console.log\n    });\n  });\n  \n}\n","const noop = (() => {});\n\n// export function virtualContracts(onContractsRequested, observers) {\n//   observers = observers ? {...observers} : {};\n//   observers = {\n//     onContractTxRequested: observers.onContractTxRequested || noop,\n//     onContractTxCancelled: observers.onContractTxCancelled || noop,\n//     onContractTxSent: observers.onContractTxSent || noop,\n//   }\n//   const {onContractTxRequested, onContractTxCancelled, onContractTxSent} = observers;\n  \n//   const fakeContracts = {};\n//   return new Proxy(fakeContracts, {\n//     get: (obj, contractName) => {\n      \n//       if (prop === \"functions\") {\n//         return functionsProxy;\n//       } else if (contractToProxy.functions[prop]) {\n//         return proxyCall(contractToProxy.functions, prop);\n//       } else {\n//         return obj[prop];\n//       }\n//     }\n//   });\n// }\n\nexport function proxyContract(contractToProxy, name, observers) {\n  observers = observers ? {...observers} : {};\n  observers = {\n    onContractTxRequested: observers.onContractTxRequested || noop,\n    onContractTxCancelled: observers.onContractTxCancelled || noop,\n    onContractTxSent: observers.onContractTxSent || noop,\n  }\n  const {onContractTxRequested, onContractTxCancelled, onContractTxSent} = observers;\n  const proxies = {};\n\n  const functionsInterface = contractToProxy.interface.functions;\n  const nameToSig = {};\n  for (const sig of Object.keys(functionsInterface)) {\n    nameToSig[functionsInterface[sig].name] = sig;\n  }\n  \n  const contract = {};\n  for (const key of Object.keys(contractToProxy)) { // TODO populate when contract become available\n    contract[key] = contractToProxy[key];\n  }\n  contract.functions = {};\n  for (const key of Object.keys(contractToProxy.functions)) {\n    contract.functions[key] = contractToProxy.functions[key];\n  }\n\n  // TODO remove:\n  // contract._original = contractToProxy;\n\n  function proxyCall(functions, methodName) {\n    let callProxy = proxies[methodName];\n    if (!callProxy) {\n      let methodInterface = contractToProxy.interface.functions[methodName];\n      if (!methodInterface) {\n        methodInterface = contractToProxy.interface.functions[nameToSig[methodName]]\n      }\n\n      callProxy = new Proxy(functions[methodName], { // TODO empty object (to populate later when contract is available ?)\n        apply: async (method, thisArg, argumentsList) => {\n          const numArguments = argumentsList.length;\n          let overrides;\n          if (numArguments === methodInterface.inputs.length + 1 && typeof(argumentsList[numArguments - 1]) === \"object\") {\n            overrides = argumentsList[numArguments];\n          }\n          let outcome;\n          if (overrides) {\n            outcome = overrides.outcome;\n            delete overrides.outcome;\n          }\n          onContractTxRequested({name, method: methodName, overrides, outcome});\n          let tx;\n          try {\n            tx = await method.bind(functions)(...argumentsList);\n          } catch (e) {\n            onContractTxCancelled({name, method: methodName, overrides, outcome}); // TODO id to identify?\n            throw e;\n          }\n          onContractTxSent({hash: tx.hash, name, method: methodName, overrides, outcome});\n          return tx;\n        }\n      })\n      proxies[methodName] = callProxy;\n    }\n    return callProxy;\n  }\n  const functionsProxy = new Proxy(contract.functions, {\n    get: (functions, methodName) => {\n      return proxyCall(contractToProxy.functions, methodName); // TODO empty\n    }\n  });\n\n  return new Proxy(contract, {\n    get: (obj, prop) => {\n      if (prop === \"functions\") {\n        return functionsProxy;\n      } else if (contractToProxy.functions[prop]) {\n        return proxyCall(contractToProxy.functions, prop);\n      } else if (prop === \"_proxiedContract\") {\n        return contractToProxy;\n      } else {\n        return obj[prop];\n      }\n    }\n  });\n}\n\n\nfunction proxySigner(signer, applyMap, {onTxRequested, onTxCancelled, onTxSent, onSignatureRequested, onSignatureCancelled, onSignatureReceived}) {\n  applyMap = Object.assign({\n    sendTransaction: async (method, thisArg, argumentsList) => {\n      onTxRequested(argumentsList[0]);\n      let tx;\n      try {\n        tx = await method.bind(thisArg)(...argumentsList);\n      } catch (e) {\n        onTxCancelled(argumentsList[0]);\n        throw e;\n      }\n      onTxSent(tx);\n      return tx;\n    },\n    signMessage: async (method, thisArg, argumentsList) => {\n      onSignatureRequested(argumentsList[0]);\n      let signature;\n      try {\n        signature = await method.bind(thisArg)(...argumentsList);\n      } catch (e) {\n        onSignatureCancelled(argumentsList[0]);\n        throw e;\n      }\n      onSignatureReceived(signature);\n      return signature;\n    }\n  }, applyMap);\n  const proxies = {};\n\n  function getProxy(methodName, handler) {\n    let proxy = proxies[methodName]\n    if (!proxy) {\n      proxy = new Proxy(signer[methodName], handler);\n      proxies[methodName] = proxy;\n    }\n    return proxy;\n  }\n\n  return new Proxy(signer, {\n    get: (obj, prop) => {\n      const applyFunc = applyMap[prop];\n      if (applyFunc) {\n        return  getProxy(prop, {\n          apply: applyFunc\n        });\n      } else {\n        return obj[prop];\n      }\n    }\n  });\n}\n\nfunction proxyUncheckedJsonRpcSigner(signer, observers) {\n  return proxySigner(signer, {}, observers);\n}\n\nfunction proxyJsonRpcSigner(signer, observers) {\n  return proxySigner(signer, {\n    connectUnchecked: (method, thisArg, argumentsList) => {\n      const signer = method.bind(thisArg)(...argumentsList);\n      return proxyUncheckedJsonRpcSigner(signer, observers);\n    }\n  }, observers);\n}\n\nexport function proxyWeb3Provider(provider, observers) {\n  observers = observers ? {...observers} : {};\n  observers = {\n    onTxRequested: observers.onTxRequested || noop,\n    onTxCancelled: observers.onTxCancelled || noop,\n    onTxSent: observers.onTxSent || noop,\n    onSignatureRequested: observers.onSignatureRequested || noop,\n    onSignatureCancelled: observers.onSignatureCancelled || noop,\n    onSignatureReceived: observers.onSignatureReceived || noop\n  }\n  const getSignerProxy = new Proxy(provider.getSigner, { // TODO wallet.connect on demand if not Ready // error out if not accepted // special state ?\n    apply: (getSigner, thisArg, argumentsList) => {\n      const signer = getSigner.bind(provider)(...argumentsList);\n      return proxyJsonRpcSigner(signer, observers);\n    }\n  })\n\n  return new Proxy(provider, {\n    get: (obj, prop) => {\n      if (prop === \"getSigner\") {\n        return getSignerProxy;\n      } else {\n        return obj[prop];\n      }\n    }\n  });\n}\n","// import { isPrivateWindow } from './utils/web';\n// import {Wallet} from \"@ethersproject/wallet\";\nimport {Contract} from \"@ethersproject/contracts\";\nimport {Web3Provider} from \"@ethersproject/providers\";\nimport {makeLog} from \"./utils/log\";\nimport {writable} from \"./utils/store\";\nimport {fetchEthereum, getVendor} from \"./utils/builtin\"\nimport {timeout} from \"./utils/index.js\"\nimport {proxyContract, proxyWeb3Provider} from \"./utils/ethers\"\nlet logger;\n\nconst $wallet = {\n    builtin: {\n      status: undefined, // Probing | Available | None | Error\n      error: undefined,\n      vendor: undefined\n    },\n    balance: {\n      status: undefined, // Loading | Ready\n      amount: undefined,\n      error: undefined,\n      blockNumber: undefined\n    },\n    contracts: {},\n    status: undefined, // Loading | Locked | Ready\n    address: undefined,\n    \n    selection: undefined,  // wallet Types available\n    selected: undefined,\n    \n    error: undefined,\n  \n    pendingUserConfirmation: undefined, // [] array of type of request\n};\nconst $transactions = [];\nconst walletStore = writable($wallet);\nconst transactionsStore = writable($transactions);\nfunction addTransaction(obj) {\n  $transactions.push(obj);\n  transactionsStore.set($transactions);\n}\nfunction set(obj) {\n  for (let key of Object.keys(obj)) {\n    if ($wallet[key] && typeof obj[key] === \"object\") {\n      for (let subKey of Object.keys(obj[key])) { // TODO recursve\n        $wallet[key][subKey] = obj[key][subKey];\n      }\n    } else {\n      $wallet[key] = obj[key];\n    }\n  }\n  logger.debug('WALLET', JSON.stringify($wallet, null, '  '));\n  walletStore.set($wallet);\n}\n\nfunction reset(fields) {\n  if (typeof fields === \"string\") {\n    fields = [fields];\n  }\n  for(const field of fields) {\n    const current = $wallet[field];\n    if (typeof current === \"object\") {\n      $wallet[field] = {status:undefined};\n    } else {\n      $wallet[field] = undefined;\n    }\n  }\n}\n// //////////////////////////////////////////////////////////////////////////////\n\nlet _ethersProvider;\nlet _web3Provider;\nlet _builtinEthersProvider;\nlet _builtinWeb3Provider;\nlet _chainConfigs;\nlet _currentModule;\nlet _selection;\n\nfunction isHex(value) {\n  return typeof value === 'string' && value.length > 2 && value.slice(0,2).toLowerCase() === \"0x\";\n}\n\nfunction toDecimal(value) {\n  if (isHex(value)) {\n    return \"\" + parseInt(value.slice(2));\n  }\n  return value;\n}\n\nfunction toHex(value) {\n  if (isHex(value)) {\n    return value;\n  }\n  return \"0x\" + parseInt(value).toString(16);\n}\n\nfunction requestUserAttention(type) {\n  if ($wallet.pendingUserConfirmation) {\n    $wallet.pendingUserConfirmation.push(type);\n  } else {\n    $wallet.pendingUserConfirmation = [type];\n  }\n  set({pendingUserConfirmation: $wallet.pendingUserConfirmation});\n}\nfunction cancelUserAttention(type) {\n  if ($wallet.pendingUserConfirmation) {\n    const index = $wallet.pendingUserConfirmation.indexOf(type);\n    if (index >= 0) {\n      $wallet.pendingUserConfirmation.splice(index, 1);\n      if ($wallet.pendingUserConfirmation.length === 0) {\n        $wallet.pendingUserConfirmation = undefined;\n      }\n      set({pendingUserConfirmation: $wallet.pendingUserConfirmation});\n    }\n  }\n}\n\nconst _observers = {\n  onTxRequested: (transaction) => {\n    requestUserAttention(\"transaction\");\n  },\n  onTxCancelled: (error) => {\n    cancelUserAttention(\"transaction\");\n  },\n  onTxSent: (tx) => {\n    cancelUserAttention(\"transaction\");\n  },\n  onSignatureRequested: (message) => {\n    requestUserAttention(\"signature\");\n  },\n  onSignatureCancelled: (error) => {\n    cancelUserAttention(\"signature\");\n  },\n  onSignatureReceived: (signature) => {\n    cancelUserAttention(\"signature\");\n  },\n  onContractTxRequested: ({name, method, overrides, outcome}) => {\n    // console.log(\"onContractTxRequest\", {name, method, overrides, outcome});\n  },\n  onContractTxCancelled: (error) => {\n  },\n  onContractTxSent: ({hash, name, method, overrides, outcome}) => {\n    console.log(\"onContractTxSent\", {hash, name, method, overrides, outcome});\n    addTransaction({hash, name, method, overrides, outcome});\n  }\n}\n\nconst LOCAL_STORAGE_SLOT = \"_web3w_previous_wallet_type\"\nfunction recordSelection(type) {\n  localStorage.setItem(LOCAL_STORAGE_SLOT, type);\n}\n\nfunction fetchPreviousSelection() {\n  return localStorage.getItem(LOCAL_STORAGE_SLOT);\n}\n\n\nasync function setupChain(address) {\n  set({chain: {status: 'Loading'}});\n\n  let contractsToAdd = {};\n  let addresses = {};\n  let contractsInfos = {};\n  const {chainId} = await _ethersProvider.getNetwork();\n  if (_chainConfigs) {\n    const chainConfigs = _chainConfigs;\n    if (typeof chainConfigs === \"function\") {\n      chainConfigs = await chainConfigs(chainId);\n    }\n    if (chainConfigs.chainId) {\n      if (chainId == chainConfigs.chainId || chainId == toDecimal(chainConfigs.chainId)) {\n        contractsInfos = chainConfigs.contracts;\n      } else {\n        const error = {message: `chainConfig only available for ${chainConfigs.chainId} , not available for ${chainId}`};\n        set({chain: {error, chainId, notSupported: true}});\n        throw new Error(error.message);;\n      }\n    } else {\n      const chainConfig = chainConfigs[chainId] || chainConfigs[toHex(chainId)];\n      if (!chainConfig) {\n        const error = {message:`chainConfig not available for ${chainId}`};\n        set({chain: {error, chainId, notSupported: true}});\n        throw new Error(error.message);;\n      } else {\n        contractsInfos = chainConfig.contracts;\n      }\n    }\n    for (const contractName of Object.keys(contractsInfos)) {\n      if (contractName === \"status\") {\n        const error = {message: `invalid name for contract : \"status\"`};\n        set({chain: {error}});\n        throw new Error(error.message);;\n      }\n      if (contractName === \"error\") {\n        const error = {message: `invalid name for contract : \"error\"`};\n        set({chain: {error}});\n        throw new Error(error.message);;\n      }\n      const contractInfo = contractsInfos[contractName];\n      if (contractInfo.abi) {\n        contractsToAdd[contractName] = proxyContract(new Contract(contractInfo.address, contractInfo.abi, _ethersProvider.getSigner(address)), contractName, _observers);\n      }\n      addresses[contractName] = contractInfo.address;\n    }\n  }\n  set({\n    chain: {\n      status: 'Ready',\n      chainId,\n      addresses,\n    },\n    contracts: {\n      ...contractsToAdd,\n      toJSON() {\n        const obj = {};\n        for (const contractName of Object.keys(contractsInfos)) {\n          obj[contractName] = {\n            address: contractsInfos[contractName].address,\n            // abi: contractsInfos[contractName].abi\n          }\n        }\n        return obj;\n      }\n    }\n  }); // TODO None ?\n}\n\nasync function select(type) {\n  if (!type) {\n    if (_selection.length === 0) {\n      type = \"builtin\";\n    } else if(_selection.length === 1) {\n      type = _selection[0];\n    } else {\n      const message = `No Wallet Type Specified, choose from ${$wallet.selection}`;\n      // set({error: {message, code: 1}}); // TODO code\n      throw new Error(message);\n    }\n  }\n  if (type == \"builtin\" && $wallet.builtin.status === \"None\") {\n    const message = `No Builtin Wallet`;\n    // set({error: {message, code: 1}}); // TODO code\n    throw new Error(message);\n  } // TODO other type: check if module registered\n  \n  reset([\"address\", \"status\", \"message\", \"selected\", \"lock\"]);\n  set({selected: type, previousType: $wallet.selected, status: \"Loading\", error: undefined});\n  _ethersProvider = null;\n  _web3Provider = null;\n  if (type === 'builtin') {\n    await probeBuiltin();\n    _ethersProvider = _builtinEthersProvider;\n    _web3Provider = _builtinWeb3Provider;\n  } else {\n    let module;\n    if (typeof type === \"string\") {\n      if (_selection) {\n        for (const choice of _selection) {\n          if (typeof choice !== \"string\" && choice.id === type) {\n            module = choice;\n          }\n        }\n      }\n    } else {\n      module = type;\n      type = module.id;\n    }\n\n    const {chainId, web3Provider} = await module.setup(module.config); // TODO pass config in select to choose network\n    _web3Provider = web3Provider;\n    _ethersProvider = proxyWeb3Provider(new Web3Provider(_web3Provider), _observers);\n    _currentModule = module;\n  }\n\n  if (!_ethersProvider) {\n    const message = `no provider found for wallet type ${type}`\n    set({error: {message, code: 1}}); // TODO code\n    throw new Error(message);\n  }\n\n  let accounts;\n  try {\n    if (type === \"builtin\" && $wallet.builtin.vendor === \"Metamask\") {\n      accounts = await timeout(2000, _ethersProvider.listAccounts(), {error: `Metamask timed out. Please reload the page (see <a href=\"https://github.com/MetaMask/metamask-extension/issues/7221\">here</a>)`}); // TODO timeout checks (metamask, portis)\n    } else {\n      // TODO timeout warning\n      accounts = await timeout(20000, _ethersProvider.listAccounts());\n    }\n  } catch (e) {\n    set({error: e});\n    throw e;\n  }\n  console.log({accounts});\n  recordSelection(type);\n  const address = accounts && accounts[0];\n  if (address) {\n    set({\n      address,\n      status: 'Ready'\n    });\n    await setupChain(address);\n  } else {\n    set({\n      address: undefined,\n      status: 'Locked',\n    });\n  }\n  \n}\n\nlet probing;\nfunction probeBuiltin(config = {}) {\n  if (probing) {\n    return probing;\n  }\n  probing = new Promise(async (resolve, reject) => {\n    if ($wallet.builtin.status) {\n      return resolve();\n    }\n    set({builtin: {status: \"Probing\"}});\n    try {\n      let ethereum = await fetchEthereum();\n      if (ethereum) {\n        _builtinWeb3Provider = ethereum;\n        _builtinEthersProvider = proxyWeb3Provider(new Web3Provider(ethereum), _observers);\n        set({builtin: {status: \"Available\", vendor: getVendor(ethereum)}}); \n        // if (config.metamaskReloadFix && $wallet.builtin.vendor === \"Metamask\") {\n        //   // see https://github.com/MetaMask/metamask-extension/issues/7221\n        //   await timeout(1000, _builtinEthersProvider.send(\"eth_chainId\", []), () => {\n        //     // window.location.reload();\n        //     console.log('RELOAD');\n        //   }); \n        // }\n      } else {\n        set({builtin: {status: \"None\", vendor: undefined}});\n      }\n    } catch (e) {\n      set({builtin: {status: \"Error\", message: e.message || e, vendor: undefined}});\n      return reject(e);\n    }\n    resolve();\n  });\n  return probing;\n}\n\n// function autoSelect() {\n//   if (!$wallet.selection || $wallet.selection.length === 0 || ($wallet.selection.length === 1 && $wallet.selection[0] === \"builtin\")) {\n//    // try to get account directly if possible (TODO: need to handle Opera quircks, also Brave)\n//     return select({\n//       provider: builtinProvider,\n//       type: \"builtin\"\n//     });\n//   }\n// }\n\nasync function connect(type) {\n  await select(type);\n  if ($wallet.status === \"Locked\") {\n    return unlock();\n  }\n  return true;\n}\n\nfunction acknowledgeError(field) {\n  if (!field) {\n    // TODO think more\n  } else if (field === \"builtin\") {\n    // TODO\n  }\n  // TODO other:\n  logout();\n}\n\nasync function logout() {\n  if (_currentModule) {\n    await _currentModule.logout();\n    _currentModule = null;\n  }\n  set({\n    balance: {\n      status: undefined, // Loading | Ready\n      amount: undefined,\n      error: undefined,\n      blockNumber: undefined\n    },\n    contracts: {},\n    status: undefined, // Loading | Locked | Ready\n    address: undefined,\n    \n    selection: undefined,  // wallet Types available\n    selected: undefined,\n    \n    error: undefined,\n    chain: {\n      status: undefined,\n      notSupported: undefined,\n      chainId: undefined,\n      error: undefined\n    },\n    // pendingUserConfirmation: undefined, // TODO ? block logout on waiting ?\n  });\n  recordSelection(\"\");\n}\n\nlet unlocking;\nfunction unlock() {\n  if (unlocking) {\n    return unlocking;\n  }\n  let resolved = false;\n  const p = new Promise(async (resolve, reject) => {\n    // TODO Unlocking to retry // TODO add timeout\n    if ($wallet.status === \"Locked\") {\n      requestUserAttention(\"unlock\");\n      let accounts;\n      try {\n        accounts = await _ethersProvider.send(\"eth_requestAccounts\", []);\n      } catch (e) {\n        accounts = [];\n      }\n      if (accounts.length > 0) {\n        const address = accounts[0];\n        cancelUserAttention(\"unlock\")\n        set({\n          address,\n          status: 'Ready'\n        });\n        await setupChain(address);\n      } else {\n        cancelUserAttention(\"unlock\");\n        unlocking = null;\n        resolved = true;\n        return resolve(false);\n      }\n      unlocking = null;\n      resolved = true;\n      return resolve(true);\n    } else {\n      resolved = true;\n      return reject(new Error(`Not Locked`));\n    }\n  });\n  if (!resolved) {\n    unlocking = p;\n  }\n  return p;\n}\n\n// /////////////////////////////////////////////////////////////////////////////////\nexport default (config) => {\n  config = {...(config || {})};\n  config.builtin = config.builtin || {};\n  const {log, debug, chainConfigs, builtin} = config;\n\n  _chainConfigs = chainConfigs;\n  logger = makeLog(log);\n  if (debug && typeof window !== 'undefined') {\n    window.$wallet = $wallet;\n    window.$transactions = $transactions;\n  }\n\n  _selection = config.selection || [];\n  set({selection: _selection.map((m) => m.id || m)});\n\n  if (process.browser) {\n    if (config.autoSelectPrevious) {\n      const type = fetchPreviousSelection();\n      if (type && type !== \"\") {\n        select(type);\n      }\n    } else if (config.builtin.autoProbe) {\n      probeBuiltin(config.builtin);\n    }\n  }\n  \n  return {\n    transactions: {\n      subscribe: transactionsStore.subscribe\n    },\n    wallet: {\n      subscribe: walletStore.subscribe,\n      probeBuiltin,\n      connect,\n      unlock,\n      acknowledgeError,\n      get contracts() {\n        return $wallet.contracts;\n      },\n      logout,\n      get address() {\n        return $wallet.address;\n      },\n      get provider() {\n        return _ethersProvider;\n      },\n      get web3Provider() {\n        return _web3Provider;\n      },\n      get chain() {\n        return $wallet.chain;\n      },\n      // get fallBackProvider() {\n      //   return _fallBackProvider;\n      // }\n    }\n  };\n};\n"],"names":["noop","Contract","Web3Provider"],"mappings":"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"}